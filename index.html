<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Examen Th√©orique Mini-Projet - Janvier 2026</title>
    <style>
        :root { --primary: #0056b3; --secondary: #6c757d; --success: #28a745; --danger: #dc3545; --warning: #ffc107; --light: #f8f9fa; --dark: #343a40; }
        
        /* --- LAYOUT --- */
        html, body { height: 100%; margin: 0; padding: 0; font-family: 'Segoe UI', sans-serif; background-color: #eef2f5; color: var(--dark); overflow: hidden; }
        body { -webkit-user-select: none; user-select: none; }

        .app-container { display: flex; flex-direction: column; height: 100vh; max-width: 1400px; margin: 0 auto; background: white; position: relative; }

        /* HEADER & FOOTER */
        .header { flex: 0 0 auto; background: var(--dark); color: white; padding: 0 20px; display: flex; justify-content: space-between; align-items: center; height: 60px; font-size: 0.95rem; }
        .footer { flex: 0 0 auto; padding: 15px 30px; background: white; border-top: 1px solid #dee2e6; display: flex; justify-content: space-between; align-items: center; height: 70px; }
        .timer-badge { background: var(--warning); color: var(--dark); padding: 5px 15px; border-radius: 20px; font-weight: bold; font-family: monospace; font-size: 1.4rem; min-width:80px; text-align:center; }

        /* CONTENU */
        .main-content { flex: 1 1 auto; display: flex; overflow: hidden; position: relative; }
        .quiz-area { flex: 1; padding: 30px; overflow-y: auto; background: white; }
        .nav-palette { width: 260px; background: #f8f9fa; border-left: 1px solid #dee2e6; padding: 15px; overflow-y: auto; }
        
        /* QUESTIONS */
        .question-card { display: none; }
        .question-card.active { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity:0; } to { opacity:1; } }
        
        .q-tag { display: inline-block; background: #e9ecef; color: var(--secondary); padding: 3px 8px; border-radius: 4px; font-size: 0.75rem; font-weight: bold; margin-bottom: 10px; text-transform: uppercase; }
        .q-text { font-size: 1.25rem; font-weight: 600; margin-bottom: 20px; color: #2c3e50; line-height: 1.4; }
        
        .option { display: flex; align-items: center; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; cursor: pointer; margin-bottom: 10px; transition: 0.2s; }
        .option:hover { background: #f8f9fa; border-color: #ced4da; }
        .option.selected { border-color: var(--primary); background-color: #e7f1ff; font-weight: 500; }
        .marker { width: 20px; height: 20px; border: 2px solid #adb5bd; margin-right: 15px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
        .marker.radio { border-radius: 50%; } .marker.check { border-radius: 4px; }
        .option.selected .marker { background: var(--primary); border-color: var(--primary); color: white; }
        .option.selected .marker::after { content: '‚úî'; font-size: 12px; }

        /* PALETTE */
        .palette-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 6px; }
        .p-btn { padding: 8px 0; border: 1px solid #dee2e6; background: white; text-align: center; border-radius: 4px; cursor: pointer; font-size: 0.85rem; }
        .p-btn.active { border-color: var(--primary); box-shadow: 0 0 0 2px var(--primary); font-weight: bold; }
        .p-btn.answered { background: var(--primary); color: white; border-color: var(--primary); }

        .btn { padding: 10px 25px; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: 1rem; }
        .btn-prev { background: #e9ecef; color: var(--dark); }
        .btn-next { background: var(--primary); color: white; }
        .btn-finish { background: var(--success); color: white; display: none; }

        /* OVERLAYS */
        .full-screen-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 2000; display: flex; flex-direction: column; align-items: center; justify-content: flex-start; padding: 40px; overflow-y: auto; }
        .input-group { margin-bottom: 20px; text-align: left; width: 100%; max-width: 450px; }
        .input-group label { display: block; font-weight: bold; margin-bottom: 8px; }
        .input-group input { width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 1rem; box-sizing: border-box; }
        
        #cheat-overlay { background: rgba(220, 53, 69, 0.98); color: white; justify-content: center; display: none; z-index: 3000; text-align: center; }

        /* TUTEUR IA */
        #socratic-assistant-container { position: fixed; bottom: 20px; right: 20px; z-index: 9999; display: flex; flex-direction: column; align-items: center; gap: 8px; pointer-events: none; }
        .ai-label { background: white; color: #7c3aed; padding: 6px 14px; border-radius: 20px; font-size: 0.85rem; font-weight: bold; border: 1px solid #e9d5ff; box-shadow: 0 4px 12px rgba(0,0,0,0.15); animation: bounce 2s infinite; pointer-events: auto; }
        #socratic-btn { background: #7c3aed; color: white; width: 60px; height: 60px; border-radius: 50%; border: none; box-shadow: 0 4px 15px rgba(124, 58, 237, 0.4); cursor: pointer; font-size: 1.8rem; pointer-events: auto; transition: transform 0.2s; }
        #socratic-btn:hover { transform: scale(1.1); }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-5px); } }

        .chat-window { position: fixed; bottom: 100px; right: 20px; width: 350px; height: 500px; background: white; border-radius: 12px; box-shadow: 0 5px 25px rgba(0,0,0,0.2); display: none; flex-direction: column; z-index: 10000; overflow: hidden; border: 1px solid #e2e8f0; pointer-events: auto; }
        .chat-header { background: #7c3aed; color: white; padding: 15px; font-weight: bold; display: flex; justify-content: space-between; align-items: center; }
        .chat-messages { flex: 1; padding: 15px; overflow-y: auto; background: #f8fafc; display: flex; flex-direction: column; gap: 10px; }
        .msg { padding: 10px 14px; border-radius: 12px; font-size: 0.95rem; max-width: 85%; }
        .msg-user { background: #7c3aed; color: white; align-self: flex-end; }
        .msg-ai { background: white; border: 1px solid #e2e8f0; align-self: flex-start; }

        .cat-stat-row { margin-bottom: 15px; width: 100%; }
        .cat-label { display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 0.9rem; font-weight: 600; }
        .progress-bg { background: #e9ecef; height: 10px; border-radius: 5px; overflow: hidden; }
        .progress-fill { height: 100%; background: var(--primary); width: 0%; transition: width 1s ease-in-out; }

        /* IMPRESSION PDF OPTIMIS√âE */
        @media print {
            body { visibility: hidden; background: white; }
            #result-screen { visibility: visible; position: absolute; left: 0; top: 0; width: 100%; height: auto; overflow: visible; display: block !important; padding: 0 !important; background: white; }
            #result-screen * { visibility: visible; }
            .no-print, #login-screen, #app-header, #app-footer, #cheat-overlay, #socratic-assistant-container { display: none !important; }
            
            /* Style des questions dans le PDF */
            .correction-item { 
                page-break-inside: avoid; 
                border: 1px solid #ddd; 
                border-radius: 8px;
                margin-bottom: 15px; 
                padding: 15px; 
                background: #fff;
            }
            #ai-coach-container { display: block !important; border: 1px solid #ccc; padding: 15px; page-break-inside: avoid; }
        }
    </style>
</head>
<body oncontextmenu="return false;">

<div id="cheat-overlay" class="full-screen-overlay">
    <div style="font-size: 4rem;">‚ö†Ô∏è</div>
    <h1>ALERTE S√âCURIT√â</h1>
    <p style="font-size: 1.2rem;">Action interdite d√©tect√©e (Sortie d'√©cran / Changement onglet).</p>
    <p>Avertissement : <span id="warn-count">0</span>/3</p>
    <button class="btn" style="background: white; color: var(--danger); margin-top: 20px;" onclick="closeCheat()">Revenir √† l'examen</button>
</div>

<div id="socratic-assistant-container">
    <span class="ai-label">ü§ñ Tuteur AI CCNA</span>
    <button id="socratic-btn" onclick="toggleChat()">üí¨</button>
    <div class="chat-window" id="chat-window">
        <div class="chat-header"><span>üéì Tuteur CCNA</span><span style="cursor:pointer;" onclick="toggleChat()">‚úñ</span></div>
        <div class="chat-messages" id="chat-messages"><div class="msg msg-ai">Bonjour. Je suis ton Tuteur. Pose ta question, je te r√©ponds directement. Je dispara√Ætrai au lancement de l'examen.</div></div>
        <div style="padding:10px; display:flex; gap:10px; border-top:1px solid #eee;">
            <input type="text" id="chat-input" style="flex:1; padding:8px; border:1px solid #ccc; border-radius:4px;" placeholder="Question..." onkeypress="if(event.key==='Enter') sendChat()">
            <button onclick="sendChat()" style="background:#7c3aed; color:white; border:none; padding:8px 12px; border-radius:4px;">‚û§</button>
        </div>
    </div>
</div>

<div id="login-screen" class="full-screen-overlay">
    <div style="margin-top: 50px;"></div> 
    <h1 style="color: var(--primary);">Examen Th√©orique Mini-Projet - Janvier 2026</h1>
    <p style="font-size: 1.1rem; color: #666;">Enseignant : <strong>Elvis TCHIMEGNI</strong></p>
    <div class="info-box">
        <h3>üîí Consignes</h3>
        <ul>
            <li><strong>Dur√©e :</strong> 50 minutes.</li>
            <li><strong>Questions :</strong> 100 QCM.</li>
            <li><strong>S√©curit√© :</strong> 3 sorties d'√©cran = Disqualification.</li>
            <li><strong>Tuteur :</strong> Disponible ici, indisponible durant l'examen.</li>
        </ul>
    </div>
    <div class="input-group"><label>Nom & Pr√©nom</label><input type="text" id="name" placeholder="Ex: ABOA LOUISE"></div>
    <div class="input-group"><label>√âtablissement</label><input type="text" id="school" placeholder="Ex: Localhost Academy"></div>
    <div class="input-group"><label>Fili√®re</label><input type="text" id="major" placeholder="Ex: Administration r√©seau et syst√®me"></div>
    <button class="btn btn-next" style="width: 100%; max-width: 450px; padding: 15px; font-size: 1.2rem; margin-top: 20px;" onclick="startExam()">LANCER L'EXAMEN</button>
    <p style="color: var(--danger); font-size: 0.9rem; margin-top: 10px;">‚ö†Ô∏è Le Tuteur dispara√Ætra au lancement.</p>
</div>

<div class="app-container">
    <div class="header" id="app-header" style="display:none;">
        <div class="user-info-bar" id="user-display"></div>
        <div class="timer-badge" id="timer">50:00</div>
    </div>
    <div class="main-content" id="app-content" style="display:none;">
        <div class="quiz-area"><div id="quiz-questions"></div></div>
        <div class="nav-palette">
            <h4 style="margin-top:0;">Navigation</h4>
            <div class="palette-grid" id="palette-grid"></div>
        </div>
    </div>
    <div class="footer" id="app-footer" style="display:none;">
        <button class="btn btn-prev" onclick="nav(-1)">Pr√©c√©dent</button>
        <div id="q-indicator" style="font-weight:bold; color:var(--secondary);">Question 1 / 100</div>
        <div>
            <button class="btn btn-next" id="next-btn" onclick="nav(1)">Suivant</button>
            <button class="btn btn-finish" id="finish-btn" onclick="checkFinish()">TERMINER</button>
        </div>
    </div>
</div>

<div id="result-screen" class="full-screen-overlay" style="display:none; align-items:flex-start;">
    <div style="border-bottom: 3px solid var(--primary); width:100%; padding-bottom:15px; margin-bottom:20px;">
        <h1 style="color:var(--primary); margin:0;">Rapport d'Examen</h1>
        <h3 style="margin:5px 0; color:#555;">Th√©orie Mini-Projet - Janvier 2026</h3>
    </div>

    <div style="display:flex; justify-content:space-between; width:100%; max-width:900px; margin-bottom:30px; background:#f8f9fa; padding:15px; border-radius:8px;">
        <div>
            <p style="margin:5px 0;"><strong>√âtudiant :</strong> <span id="res-name"></span></p>
            <p style="margin:5px 0;"><strong>Fili√®re :</strong> <span id="res-major"></span></p>
            <p style="margin:5px 0;"><strong>√âtablissement :</strong> <span id="res-school"></span></p>
        </div>
        <div style="text-align:right;">
             <p style="margin:5px 0;"><strong>Enseignant :</strong> Elvis TCHIMEGNI</p>
             <p style="margin:5px 0;"><strong>Date/Heure :</strong> <span id="res-date"></span></p>
             <p style="margin:5px 0; color:red;"><strong>Alertes Triche :</strong> <span id="res-cheats">0</span>/3</p>
        </div>
    </div>

    <div style="width:100%; text-align:center;">
        <div style="width:140px; height:140px; border-radius:50%; border:8px solid var(--primary); display:flex; justify-content:center; align-items:center; font-size:2.5rem; font-weight:bold; color:var(--primary); margin:0 auto;" id="final-score">--/100</div>
        <div id="final-decision" style="font-size:2rem; font-weight:bold; margin-top:10px;"></div>
    </div>

    <div style="width:100%; max-width:900px; margin:20px 0;" id="category-stats-container"></div>
    
    <p id="mail-status" style="font-weight:bold; color:var(--primary); text-align:center; width:100%;" class="no-print">Pr√©paration de l'envoi...</p>
    
    <div class="no-print" style="width:100%; text-align:center; margin:20px 0;">
        <button class="btn btn-primary" onclick="window.print()">üñ®Ô∏è Imprimer le Rapport PDF</button><br><br>
        <button id="btn-generate-ai" class="btn" style="background: linear-gradient(135deg, #10b981, #059669); color:white; border:none; padding:12px 20px;" onclick="generateAICoach()">‚ú® Obtenir l'Analyse du Coach</button>
    </div>

    <div id="ai-coach-container" style="display:none; width:100%; max-width:900px; background:#f0fdf4; padding:20px; border-radius:8px; border:2px solid #bbf7d0; margin-bottom:30px;">
        <div style="font-weight:bold; color:#15803d; font-size:1.3rem; margin-bottom:10px; border-bottom:1px solid #bbf7d0; padding-bottom:5px;">ü§ñ Analyse Strat√©gique du Coach</div>
        <div id="ai-coach-content" style="line-height:1.6; color:#064e3b;">Chargement...</div>
    </div>

    <h3 style="width:100%; max-width:900px; border-bottom:1px solid #ccc; padding-bottom:10px;">D√©tail des R√©ponses et Corrections</h3>
    <div id="correction-area" style="width:100%; max-width:900px; margin-bottom:50px;"></div>
</div>

<script>
// --- CONFIGURATION ---
const REQUIRED_Q = 100, PASS_SCORE = 80, DURATION_MIN = 50;
const PART_1 = "gsk_"; 
const PART_2 = "3c2NtKTExpZrRBxMbyCzWGdyb3FYU9fwh4cBd1bxJRwi35zyuRpJ"; // Mettez ici la fin de la cl√© (apr√®s le gsk_)
const API_KEY = PART_1 + PART_2;

// --- S√âCURIT√â ANTI-REJEU ---
if (localStorage.getItem("examen_ia_termine") === "true") {
    document.body.innerHTML = `
        <div style="display:flex; justify-content:center; align-items:center; height:100vh; flex-direction:column; font-family:sans-serif; text-align:center;">
            <div style="font-size:4rem;">‚õî</div>
            <h1 style="color:#dc2626;">Acc√®s Refus√©</h1>
            <p style="font-size:1.2rem;">Vous avez d√©j√† soumis votre copie pour cet examen.</p>
            <p style="color:#666;">Contactez l'enseignant ELVIS TCHIMEGNI.</p>
        </div>
    `;
    throw new Error("Examen d√©j√† pass√© !"); // Stoppe l'ex√©cution du reste du script
}


// --- BASE DE DONN√âES (CORRIG√âE : SANS IMAGES) ---
const FULL_DB = [
    // MULTI-CHOIX
    { category: "Transport", type: 'multi', count: 2, q: "Quels sont les deux principaux protocoles de la couche Transport du mod√®le TCP/IP ?", options: ["IP", "TCP", "HTTP", "UDP", "Ethernet"], a: [1, 3], e: "TCP (fiable) et UDP (rapide) sont les protocoles de couche 4." },
    { category: "Switching", type: 'multi', count: 2, q: "Quels sont deux avantages majeurs de l'impl√©mentation des VLANs dans un r√©seau ?", options: ["R√©duction des domaines de diffusion", "Augmentation de la latence", "Am√©lioration de la s√©curit√©", "Suppression du routage"], a: [0, 2], e: "Les VLANs segmentent les broadcasts et isolent les groupes." },
    { category: "Adressage", type: 'multi', count: 3, q: "Quelles sont les trois plages d'adresses IP priv√©es d√©finies par la RFC 1918 ?", options: ["10.0.0.0/8", "172.16.0.0/12", "11.0.0.0/8", "192.168.0.0/16", "209.165.200.0/24"], a: [0, 1, 3], e: "10.x.x.x, 172.16-31.x.x et 192.168.x.x sont priv√©es." },
    { category: "Fondamentaux", type: 'multi', count: 2, q: "Quels √©quipements r√©seau fonctionnent au niveau de la couche 2 (Liaison de donn√©es) ?", options: ["Switch", "Hub", "Pont (Bridge)", "R√©p√©teur"], a: [0, 2], e: "Switch et Pont utilisent les adresses MAC." },

    // CHOIX UNIQUE
    { category: "Fondamentaux", q: "Quelle est la caract√©ristique fondamentale d'un r√©seau convergent ?", options: ["Il utilise uniquement la fibre optique", "Il transporte voix, vid√©o et donn√©es sur une m√™me infrastructure", "Il s√©pare physiquement le t√©l√©phone et l'informatique", "Il ne n√©cessite aucun routeur"], a: 1, e: "La convergence unifie tous les types de trafic sur un seul r√©seau." },
    { category: "Fondamentaux", q: "Dans une architecture r√©seau, quel √©l√©ment assure la tol√©rance aux pannes ?", options: ["Le co√ªt √©lev√©", "La redondance des liens et √©quipements", "L'utilisation du Wi-Fi", "La suppression des pare-feu"], a: 1, e: "La redondance garantit la continuit√© de service." },
    { category: "Fondamentaux", q: "Quel type de r√©seau s'√©tend sur une large zone g√©ographique (g√©r√© par un FAI) ?", options: ["LAN", "WLAN", "WAN", "PAN"], a: 2, e: "WAN = Wide Area Network." },
    { category: "Fondamentaux", q: "Quelle couche du mod√®le OSI g√®re le routage et l'adressage IP ?", options: ["Physique", "Liaison de donn√©es", "R√©seau", "Transport"], a: 2, e: "Couche 3 : R√©seau (Paquets)." },
    { category: "Transport", q: "Quelle est l'unit√© de donn√©es (PDU) de la couche Transport ?", options: ["Trame", "Paquet", "Segment", "Bit"], a: 2, e: "Transport = Segment." },
    { category: "Services IP", q: "Quel protocole permet de traduire les noms de domaine en adresses IP ?", options: ["DHCP", "DNS", "HTTP", "FTP"], a: 1, e: "DNS = Domain Name System." },
    { category: "Gestion", q: "Quelle commande permet de passer en mode privil√©gi√© ?", options: ["configure terminal", "enable", "login", "exit"], a: 1, e: "La commande est 'enable'." },
    { category: "S√©curit√©", q: "Quelle commande permet de chiffrer tous les mots de passe en clair dans la configuration ?", options: ["enable secret", "service password-encryption", "line console 0", "copy run start"], a: 1, e: "Service password-encryption applique un chiffrement faible." },
    { category: "Switching", q: "Que faut-il configurer sur un switch pour pouvoir le g√©rer √† distance ?", options: ["Une interface Loopback", "Une interface SVI (Vlan) avec une IP", "Le protocole OSPF", "Un c√¢ble console"], a: 1, e: "Une SVI (Switch Virtual Interface) est n√©cessaire pour l'IP de gestion." },
    { category: "Adressage", q: "Quelle est la longueur en bits d'une adresse IPv4 ?", options: ["32 bits", "48 bits", "64 bits", "128 bits"], a: 0, e: "32 bits (4 octets)." },
    { category: "Adressage", q: "Quelle est l'adresse de broadcast pour le r√©seau 192.168.10.0/24 ?", options: ["192.168.10.1", "192.168.10.0", "192.168.10.254", "192.168.10.255"], a: 3, e: "La derni√®re adresse de la plage est le broadcast." },
    { category: "Adressage", q: "Quelle est la fonction principale du masque de sous-r√©seau ?", options: ["Crypter les donn√©es", "Distinguer la partie r√©seau de la partie h√¥te", "Traduire les noms DNS", "Attribuer une IP automatiquement"], a: 1, e: "Il s√©pare le NetID du HostID." },
    { category: "Adressage", q: "Quelle est la plage d'adresses priv√©es de classe C ?", options: ["10.0.0.0/8", "172.16.0.0/12", "192.168.0.0/16", "169.254.0.0/16"], a: 2, e: "192.168.x.x est la classe C priv√©e." },
    { category: "IPv6", q: "Combien de bits compose une adresse IPv6 ?", options: ["32", "64", "128", "256"], a: 2, e: "128 bits." },
    { category: "IPv6", q: "Quelle est la compression correcte pour l'adresse IPv6 2001:0db8:0000:0000:0000:0000:0000:0001 ?", options: ["2001:db8:0:0:0:0:0:1", "2001:db8::1", "2001:db8:::1", "2001:db8::"], a: 1, e: "Le double deux-points remplace la plus longue suite de z√©ros." },
    { category: "IPv6", q: "Par quel pr√©fixe commence une adresse IPv6 Link-local ?", options: ["2001::", "fe80::", "::1", "ff00::"], a: 1, e: "fe80:: est r√©serv√© au lien local." },
    { category: "Routage", q: "Quelle commande permet d'afficher la table de routage ?", options: ["show ip int brief", "show run", "show ip route", "ping"], a: 2, e: "show ip route." },
    { category: "Routage", q: "Que signifie la lettre 'C' dans la table de routage ?", options: ["Connect√© directement", "Statique", "OSPF", "RIP"], a: 0, e: "C = Connected." },
    { category: "Routage", q: "Que repr√©sente la distance administrative (AD) d'un protocole ?", options: ["La distance physique", "Le nombre de sauts", "La fiabilit√© de la source de routage", "La vitesse du lien"], a: 2, e: "Plus l'AD est basse, plus le protocole est fiable." },
    { category: "Routage", q: "Quel protocole de routage utilise le nombre de sauts comme seule m√©trique ?", options: ["OSPF", "EIGRP", "RIP", "BGP"], a: 2, e: "RIP (Max 15 sauts)." },
    { category: "Switching", q: "Quelle commande configure la passerelle par d√©faut sur un switch ?", options: ["ip route", "ip default-gateway", "interface vlan 1", "ip address"], a: 1, e: "ip default-gateway en mode config globale." },
    { category: "S√©curit√©", q: "Quel est l'avantage principal de SSH par rapport √† Telnet ?", options: ["Plus rapide", "Plus facile", "Chiffre les communications", "Ne n√©cessite pas de login"], a: 2, e: "SSH est s√©curis√©, Telnet est en clair." },
    { category: "Fondamentaux", q: "Lors de l'encapsulation de la couche Transport vers R√©seau, que devient le segment ?", options: ["Un paquet", "Une trame", "Des bits", "Une adresse MAC"], a: 0, e: "Le PDU de couche 3 est le Paquet." },
    { category: "Gestion", q: "Quelle commande permet de voir la configuration de d√©marrage (NVRAM) ?", options: ["show running-config", "show startup-config", "show version", "show flash"], a: 1, e: "startup-config." },
    { category: "Services IP", q: "Quel est le r√¥le du protocole DHCP ?", options: ["Routage", "Traduction de nom", "Attribution dynamique d'IP", "Transfert de fichier"], a: 2, e: "Dynamic Host Configuration Protocol." },
    { category: "Adressage", q: "Quelle est l'adresse de bouclage IPv4 (localhost) ?", options: ["127.0.0.1", "192.168.1.1", "0.0.0.0", "255.255.255.255"], a: 0, e: "127.0.0.1." },
    { category: "Gestion", q: "Quelle commande permet de nommer un routeur ?", options: ["name", "hostname", "description", "title"], a: 1, e: "hostname [nom]." },
    { category: "Gestion", q: "Quel est le but de la commande 'banner motd' ?", options: ["R√©gler l'heure", "Afficher un message d'avertissement l√©gal", "Changer le nom du routeur", "Configurer le mot de passe"], a: 1, e: "Message Of The Day." },
    { category: "Adressage", q: "Quelle est la notation CIDR pour le masque 255.255.255.0 ?", options: ["/8", "/16", "/24", "/32"], a: 2, e: "24 bits √† 1." },
    { category: "S√©curit√©", q: "Quel protocole s√©curis√© est utilis√© pour l'administration en ligne de commande ?", options: ["Telnet", "HTTP", "SSH", "TFTP"], a: 2, e: "SSH (Secure Shell)." },
    { category: "Gestion", q: "Quelle commande permet d'activer une interface r√©seau ?", options: ["enable", "start", "no shutdown", "activation"], a: 2, e: "no shutdown." },
    { category: "Fondamentaux", q: "Quel est le r√¥le du champ TTL dans un paquet IP ?", options: ["Augmenter la vitesse", "√âviter les boucles infinies", "V√©rifier les erreurs", "Identifier la source"], a: 1, e: "Time To Live d√©cr√©mente √† chaque saut." },
    { category: "Fondamentaux", q: "Quel protocole est utilis√© par la commande Ping ?", options: ["HTTP", "ICMP", "TCP", "UDP"], a: 1, e: "ICMP Echo Request/Reply." },
    { category: "Fondamentaux", q: "Quelle est la diff√©rence principale entre les mod√®les TCP/IP et OSI ?", options: ["TCP/IP a 7 couches", "TCP/IP a 4 couches", "Ils sont identiques", "OSI est pour le wifi"], a: 1, e: "TCP/IP est un mod√®le pratique √† 4 couches." },
    { category: "Fondamentaux", q: "Quel type de communication est 'Un vers plusieurs' (groupe) ?", options: ["Unicast", "Broadcast", "Multicast", "Simulcast"], a: 2, e: "Multicast." },
    { category: "IPv6", q: "Que signifie le pr√©fixe /64 dans une adresse IPv6 standard ?", options: ["64 bits r√©seau / 64 bits h√¥te", "L'adresse fait 64 bits", "Les 64 derniers bits sont le r√©seau", "C'est une adresse multicast"], a: 0, e: "C'est le d√©coupage standard pour un LAN IPv6." },
    { category: "Fondamentaux", q: "Quel organisme g√®re l'allocation des adresses IP au niveau mondial ?", options: ["IEEE", "IANA/ICANN", "W3C", "ISO"], a: 1, e: "IANA." },
    { category: "Switching", q: "Quel √©quipement de couche 2 utilise les adresses MAC pour commuter ?", options: ["Hub", "Routeur", "Switch", "Serveur"], a: 2, e: "Le Switch." },
    { category: "Cloud", q: "Que signifie l'acronyme SaaS ?", options: ["Storage as a Service", "Software as a Service", "System as a Service", "Switch as a Service"], a: 1, e: "Logiciel en tant que service." },
    { category: "Adressage", q: "Que signifie une adresse IP en 169.254.x.x ?", options: ["Internet OK", "DHCP OK", "√âchec DHCP (APIPA)", "C'est une IPv6"], a: 2, e: "Adresse auto-assign√©e (APIPA)." },
    { category: "Adressage", q: "Quel masque de sous-r√©seau correspond √† la notation /27 ?", options: ["255.255.255.192", "255.255.255.224", "255.255.255.240", "255.255.255.248"], a: 1, e: "/27 = 24 bits + 3 bits = 11100000 = .224." },
    { category: "Gestion", q: "Quelle commande permet de sauvegarder la configuration en cours en m√©moire NVRAM ?", options: ["save", "write memory", "copy running-config startup-config", "copy start run"], a: 2, e: "Copie de la RAM vers la NVRAM." },
    { category: "Fondamentaux", q: "√Ä quelle couche du mod√®le OSI appartient l'adresse MAC ?", options: ["Physique", "Liaison de donn√©es", "R√©seau", "Transport"], a: 1, e: "Couche 2 (Liaison)." },
    { category: "Services IP", q: "Quel est le port par d√©faut utilis√© par le protocole HTTP ?", options: ["21", "23", "80", "443"], a: 2, e: "Port 80." },
    { category: "S√©curit√©", q: "Quel est le port par d√©faut utilis√© par le protocole HTTPS ?", options: ["80", "8080", "443", "22"], a: 2, e: "Port 443." },
    { category: "Physique", q: "Quel type de c√¢ble est utilis√© pour relier un PC √† un Switch ?", options: ["Crois√©", "Droit", "Console", "Fibre"], a: 1, e: "C√¢ble droit (Straight-through)." },
    { category: "Physique", q: "Quel type de c√¢ble est utilis√© pour relier deux switchs entre eux ?", options: ["Crois√©", "Droit", "Console", "S√©rie"], a: 0, e: "C√¢ble crois√© (Crossover)." },
    { category: "Adressage", q: "Quelle est la plage d'adresses d√©finie pour la classe B ?", options: ["1-126", "128-191", "192-223", "224-239"], a: 1, e: "128.0.0.0 √† 191.255.0.0." },
    { category: "Services IP", q: "Quel protocole est utilis√© pour r√©soudre une adresse MAC en adresse IP ?", options: ["ARP", "RARP", "DNS", "DHCP"], a: 1, e: "RARP (Reverse ARP)." },
    { category: "Services IP", q: "Quel protocole est utilis√© pour r√©soudre une adresse IP en adresse MAC ?", options: ["ARP", "DNS", "DHCP", "ICMP"], a: 0, e: "ARP (Address Resolution Protocol)." },
    { category: "Gestion", q: "Quelle commande permet d'afficher la version de l'IOS et le registre de configuration ?", options: ["show running-config", "show flash", "show version", "show startup"], a: 2, e: "show version." },
    { category: "Adressage", q: "Quelle est l'adresse de r√©seau pour l'h√¥te 192.168.1.33 avec un masque /27 ?", options: ["192.168.1.0", "192.168.1.30", "192.168.1.32", "192.168.1.31"], a: 2, e: "Le pas est de 32. 33 est dans le sous-r√©seau commen√ßant √† .32." },
    { category: "Services IP", q: "Quel est le but principal de la traduction d'adresses r√©seau (NAT) ?", options: ["Traduire les IP priv√©es en IP publiques", "Chiffrer les donn√©es", "Router les paquets", "Bloquer les virus"], a: 0, e: "Permet d'√©conomiser les adresses IPv4 publiques." },
    { category: "Switching", q: "Quel appareil permet de segmenter les domaines de collision mais pas les domaines de diffusion ?", options: ["Hub", "Switch", "Routeur", "R√©p√©teur"], a: 1, e: "Le switch cr√©e un domaine de collision par port." },
    { category: "Routage", q: "Si les protocoles OSPF et EIGRP sont configur√©s, quel protocole sera choisi par le routeur pour acheminer le trafic ?", options: ["OSPF", "EIGRP", "BGP", "RIP"], a: 1, e: "EIGRP a une distance administrative (90) inf√©rieure √† OSPF (110)." },
    { category: "Routage", q: "Si les protocoles RIP et OSPF sont configur√©s, quel protocole sera choisi par le routeur ?", options: ["RIP", "OSPF", "Le premier configur√©", "Al√©atoire"], a: 1, e: "OSPF (110) a une priorit√© plus √©lev√©e que RIP (120)." },
    { category: "Routage", q: "Quelle commande permet de d√©sactiver le protocole RIP ?", options: ["no router rip", "disable rip", "stop rip", "rip off"], a: 0, e: "Mode configuration globale." },
    { category: "Physique", q: "Quelle est la forme du signal transmis dans une fibre optique ?", options: ["Impulsions √©lectriques", "Impulsions lumineuses", "Ondes radio", "Sonore"], a: 1, e: "La lumi√®re." },
    { category: "Physique", q: "Quelle est la forme du signal transmis dans un c√¢ble coaxial ?", options: ["Impulsions √©lectriques", "Impulsions lumineuses", "Ondes radio", "Magn√©tique"], a: 0, e: "L'√©lectricit√©." },
    { category: "Adressage", q: "Quel est le masque de sous-r√©seau par d√©faut pour la classe A ?", options: ["255.0.0.0", "255.255.0.0", "255.255.255.0", "0.0.0.0"], a: 0, e: "/8." },
    { category: "Adressage", q: "Quel est le masque de sous-r√©seau par d√©faut pour la classe B ?", options: ["255.0.0.0", "255.255.0.0", "255.255.255.0", "0.0.0.0"], a: 1, e: "/16." },
    { category: "Adressage", q: "Combien d'adresses h√¥tes utilisables contient un sous-r√©seau /24 ?", options: ["256", "254", "255", "253"], a: 1, e: "256 - 2 (r√©seau + broadcast) = 254." },
    { category: "Gestion", q: "Quelle commande permet d'attribuer une description √† une interface ?", options: ["name", "description", "label", "comment"], a: 1, e: "description [texte]." },
    { category: "Routage", q: "Quelle commande permet de d√©sactiver le routage IP sur un routeur ?", options: ["no ip routing", "no router", "stop routing", "shutdown"], a: 0, e: "Transforme le routeur en simple h√¥te." },
    { category: "S√©curit√©", q: "Quelle commande d'ACL permet de bloquer le trafic ICMP (Ping) ?", options: ["access-list deny icmp", "no ping", "block icmp", "stop ping"], a: 0, e: "deny icmp." },
    { category: "S√©curit√©", q: "Quelle est la r√®gle implicite qui se trouve √† la fin de toute ACL ?", options: ["Permit any", "Deny any (Tout refuser)", "Permit local", "Log"], a: 1, e: "Tout ce qui n'est pas autoris√© est interdit." },
    { category: "S√©curit√©", q: "Quelle commande permet d'afficher les listes de contr√¥le d'acc√®s (ACL) ?", options: ["show access-lists", "show rules", "display acl", "show filter"], a: 0, e: "Affiche les ACLs configur√©es." },
    { category: "IPv6", q: "Quelle est l'adresse de boucle locale (Loopback) en IPv6 ?", options: ["::1", "127.0.0.1", "::", "FE80::1"], a: 0, e: "::1." },
    { category: "IPv6", q: "Dans le format EUI-64, quel bit de l'adresse MAC est invers√© ?", options: ["Le 7√®me bit", "Le 1er bit", "Le dernier bit", "Aucun"], a: 0, e: "Le bit U/L (Universel/Local)." },
    { category: "IPv6", q: "Quel protocole permet l'autoconfiguration IPv6 sans √©tat (SLAAC) ?", options: ["DHCPv6", "NDP", "Static", "EUI"], a: 1, e: "Utilise les annonces de routeur (RA)." },
    { category: "IPv6", q: "Quel message NDP est utilis√© pour annoncer la pr√©sence d'un routeur ?", options: ["NS", "NA", "RS", "RA (Router Advertisement)"], a: 3, e: "RA." },
    { category: "IPv6", q: "Quel message NDP est utilis√© pour solliciter l'adresse MAC d'un voisin ?", options: ["NS (Neighbor Solicitation)", "NA", "RS", "RA"], a: 0, e: "√âquivalent de la requ√™te ARP." },
    { category: "IPv6", q: "Quelle est l'adresse multicast IPv6 pour 'Tous les n≈ìuds' ?", options: ["FF02::1", "FF02::2", "FF02::5", "FF02::A"], a: 0, e: "All Nodes." },
    { category: "Gestion", q: "Quelle est l'extension de fichier typique d'une image Cisco IOS ?", options: [".bin", ".exe", ".iso", ".tar"], a: 0, e: "Fichier binaire." },
    { category: "Gestion", q: "Quel syst√®me de fichiers Cisco permet de g√©rer les fichiers en ligne de commande ?", options: ["IFS (IOS File System)", "NTFS", "FAT", "EXT"], a: 0, e: "IFS." },
    { category: "Gestion", q: "Quelle commande permet de lister les fichiers dans la m√©moire flash ?", options: ["ls", "dir", "list", "show files"], a: 1, e: "dir flash:." },
    { category: "Gestion", q: "Quelle commande permet d'effacer un fichier de la m√©moire flash ?", options: ["delete", "remove", "erase", "rm"], a: 0, e: "delete flash:filename." },
    { category: "Gestion", q: "Quelle commande permet de v√©rifier l'int√©grit√© d'un fichier IOS (MD5) ?", options: ["verify", "check", "md5", "hash"], a: 0, e: "verify /md5." },
    { category: "S√©curit√©", q: "Quel est le masque wildcard correspondant au masque /24 ?", options: ["0.0.0.255", "255.255.255.0", "0.0.255.255", "0.0.0.0"], a: 0, e: "L'inverse binaire de 255.255.255.0." },
    { category: "Gestion", q: "Quelle commande permet de voir l'historique des commandes saisies ?", options: ["show history", "history", "recall", "list"], a: 0, e: "Affiche le tampon historique." },
    { category: "Gestion", q: "Quelle est la taille par d√©faut de l'historique de commandes ?", options: ["10 lignes", "20 lignes", "50 lignes", "100 lignes"], a: 0, e: "10 commandes." },
    { category: "Gestion", q: "Quelle commande permet de remettre le routeur en configuration d'usine ?", options: ["erase startup-config", "delete nvram", "reset", "factory"], a: 0, e: "Puis 'reload'." },
    { category: "Services IP", q: "Quel port est utilis√© par le canal de donn√©es FTP ?", options: ["20", "21", "22", "23"], a: 0, e: "Port 20." },
    { category: "Services IP", q: "Quel port est utilis√© par le canal de contr√¥le FTP ?", options: ["20", "21", "22", "23"], a: 1, e: "Port 21." },
    { category: "Physique", q: "Quelle topologie r√©seau poss√®de un point central de connexion ?", options: ["√âtoile", "Bus", "Anneau", "Maill√©e"], a: 0, e: "Topologie Star." },
    { category: "Physique", q: "Quelle topologie r√©seau offre la meilleure redondance ?", options: ["Maill√©e compl√®te", "√âtoile", "Bus", "Anneau"], a: 0, e: "Tous les n≈ìuds sont connect√©s entre eux." },
    { category: "Physique", q: "Quel type de fibre optique est utilis√© pour les longues distances ?", options: ["Monomode", "Multimode", "Coax", "UTP"], a: 0, e: "Source Laser." },
    { category: "Physique", q: "Quel type de fibre optique utilise une LED comme source lumineuse ?", options: ["Monomode", "Multimode", "Coax", "UTP"], a: 1, e: "Courte distance." },
    { category: "Physique", q: "Quelle cat√©gorie de c√¢ble Ethernet supporte 1 Gbps au minimum ?", options: ["Cat5e", "Cat3", "Cat4", "Coax"], a: 0, e: "Cat5e ou Cat6." },
    { category: "Physique", q: "Quelle est la distance maximale th√©orique d'un c√¢ble UTP Ethernet ?", options: ["100 m√®tres", "50 m√®tres", "200 m√®tres", "500 m√®tres"], a: 0, e: "Standard 100m." },
    { category: "Gestion", q: "Quelle commande Windows permet d'afficher le cache ARP ?", options: ["arp -a", "show arp", "ip arp", "getmac"], a: 0, e: "Commande DOS." },
    { category: "Gestion", q: "Quelle commande Windows permet d'afficher la configuration IP ?", options: ["ipconfig", "ifconfig", "show ip", "ip addr"], a: 0, e: "ifconfig est pour Linux." },
    { category: "Gestion", q: "Quelle commande Windows permet de tracer la route vers une destination ?", options: ["tracert", "traceroute", "trace", "pathping"], a: 0, e: "tracert (traceroute sur Cisco)." },

    // --- CONCEPTS R√âSEAU ---
    { category: "Fondamentaux", q: "Quel p√©riph√©rique r√©seau a pour fonction principale de d√©terminer le meilleur chemin pour les paquets ?", options: ["Le P√©riph√©rique interm√©diaire (Routeur)", "Le P√©riph√©rique final", "Le Serveur", "Le Support de transmission"], a: 0, e: "Les routeurs prennent les d√©cisions de routage bas√©es sur les adresses IP." },
    { category: "Fondamentaux", q: "Quelle est la diff√©rence majeure entre un r√©seau WAN et un r√©seau LAN ?", options: ["Le WAN interconnecte des r√©seaux sur de vastes zones g√©ographiques.", "Le WAN est administr√© localement par une entreprise.", "Le WAN couvre uniquement une maison.", "Le WAN offre toujours plus de d√©bit que le LAN."], a: 0, e: "WAN signifie Wide Area Network (R√©seau √©tendu)." },
    { category: "Fondamentaux", q: "Que signifie le concept de 'tol√©rance aux pannes' en r√©seau ?", options: ["Limiter l'impact d'une panne et permettre une r√©cup√©ration rapide.", "Prot√©ger le r√©seau contre les piratages.", "Permettre au r√©seau de s'√©tendre rapidement.", "Prioriser la voix sur les donn√©es."], a: 0, e: "C'est la capacit√© du r√©seau √† continuer de fonctionner malgr√© une d√©faillance." },
    { category: "Fondamentaux", q: "Quel est le but principal de l'encapsulation des donn√©es ?", options: ["Ajouter des en-t√™tes de protocole √† chaque couche du mod√®le.", "Compresser les donn√©es pour gagner de la place.", "Chiffrer les donn√©es pour la s√©curit√©.", "Diviser les messages en petits morceaux."], a: 0, e: "Les donn√©es deviennent Segment, puis Paquet, puis Trame." },
    { category: "Fondamentaux", q: "Quelle couche du mod√®le TCP/IP regroupe les fonctions des couches Physique et Liaison du mod√®le OSI ?", options: ["La couche Acc√®s r√©seau", "La couche Transport", "La couche Application", "La couche Internet"], a: 0, e: "C'est la couche la plus basse du mod√®le TCP/IP." },
    { category: "Fondamentaux", q: "Quel organisme international g√®re l'allocation des adresses IP publiques et des noms de domaine ?", options: ["L'ICANN (IANA)", "L'IEEE", "L'ISO", "La TIA"], a: 0, e: "Internet Corporation for Assigned Names and Numbers." },
    { category: "Gestion", q: "Dans quel type de m√©moire est stock√©e la configuration en cours (running-config) ?", options: ["En RAM", "En NVRAM", "En Flash", "En ROM"], a: 0, e: "La RAM est volatile, d'o√π la perte de config au red√©marrage si non sauvegard√©e." },
    { category: "Adressage", q: "Quelle op√©ration logique est utilis√©e par un routeur pour d√©terminer l'adresse r√©seau √† partir d'une IP ?", options: ["Le ET logique (AND)", "Le OU logique (OR)", "Le OU exclusif (XOR)", "L'inversion (NOT)"], a: 0, e: "Adresse IP + Masque (AND) = Adresse R√©seau." },
    { category: "IPv6", q: "Quelle est la raison principale ayant motiv√© le d√©veloppement du protocole IPv6 ?", options: ["L'√©puisement des adresses IPv4 publiques.", "L'am√©lioration de la s√©curit√©.", "L'augmentation de la vitesse de transmission.", "La complexit√© de configuration d'IPv4."], a: 0, e: "Les 4,3 milliards d'adresses IPv4 ne suffisaient plus." },
    { category: "IPv6", q: "Quel est le pr√©fixe de sous-r√©seau standard recommand√© pour un LAN en IPv6 ?", options: ["/64", "/32", "/48", "/128"], a: 0, e: "Le /64 est n√©cessaire pour le fonctionnement de l'autoconfiguration (SLAAC)." },
    
    // --- ROUTAGE & PROTOCOLES ---
    { category: "Routage", q: "Quel est l'objectif principal de la configuration d'une route statique ?", options: ["Permettre √† l'administrateur de d√©finir manuellement un chemin pr√©cis.", "Apprendre automatiquement la topologie du r√©seau.", "Connecter des PC entre eux.", "Aucun, c'est obsol√®te."], a: 0, e: "Elle offre un contr√¥le total du trafic mais ne s'adapte pas aux pannes." },
    { category: "Routage", q: "Si le 'Next-Hop' d'une route statique est une adresse IP, que doit faire le routeur ?", options: ["Effectuer une consultation r√©cursive pour trouver l'interface de sortie.", "Envoyer directement le paquet.", "Jeter le paquet.", "Envoyer un broadcast."], a: 0, e: "Il doit chercher dans la table de routage comment atteindre cette IP de saut suivant." },
    { category: "Routage", q: "Dans le processus de routage, que signifie la r√®gle du 'Longest Match' (Correspondance la plus longue) ?", options: ["Le routeur utilise la route avec le masque le plus pr√©cis (le plus long).", "Le routeur utilise le protocole le plus rapide.", "Le routeur utilise la route par d√©faut.", "Le routeur utilise la premi√®re route trouv√©e."], a: 0, e: "Un /32 sera toujours pr√©f√©r√© √† un /24 pour la m√™me destination." },
    { category: "Routage", q: "Qu'est-ce qu'une route statique flottante ?", options: ["Une route de secours avec une Distance Administrative plus √©lev√©e.", "Une route principale.", "Une route pour le trafic rapide.", "Une route sans fil."], a: 0, e: "Elle ne s'active que si la route principale (AD plus basse) tombe." },
    { category: "Routage", q: "Quels param√®tres sont utilis√©s pour calculer la m√©trique EIGRP par d√©faut ?", options: ["La Bande passante et le D√©lai", "Le nombre de Sauts", "Le Co√ªt OSPF", "La Vitesse du lien"], a: 0, e: "C'est une m√©trique composite bas√©e sur les valeurs K." },
    { category: "Routage", q: "Quel code identifie une route apprise par EIGRP dans la table de routage ?", options: ["D", "E", "O", "R"], a: 0, e: "D provient de l'algorithme DUAL utilis√© par EIGRP." },
    { category: "Routage", q: "Quel protocole de couche 3 est utilis√© par la commande Traceroute pour signaler les sauts ?", options: ["ICMP (Time Exceeded)", "UDP", "TCP", "IP"], a: 0, e: "Les routeurs renvoient un message ICMP quand le TTL expire." },
    { category: "Routage", q: "Que d√©signe le terme 'Gateway of last resort' (Passerelle de dernier recours) ?", options: ["La route par d√©faut (0.0.0.0/0).", "Le dernier routeur du r√©seau.", "La connexion Internet.", "La passerelle du PC."], a: 0, e: "C'est la route utilis√©e si aucune autre route ne correspond." },

    // --- VLAN & TRUNKING ---
    { category: "Switching", q: "Quel est l'identifiant (ID) du VLAN par d√©faut sur tous les commutateurs Cisco ?", options: ["VLAN 1", "VLAN 10", "VLAN 99", "VLAN 100"], a: 0, e: "Tous les ports sont dans le VLAN 1 par d√©faut." },
    { category: "Switching", q: "Quel est le protocole standard de l'IEEE utilis√© pour le trunking (√©tiquetage) ?", options: ["802.1Q", "ISL", "DTP", "VTP"], a: 0, e: "Dot1Q est le standard ouvert, ISL est l'ancien propri√©taire Cisco." },
    { category: "Switching", q: "Quelle commande permet de cr√©er un nouveau VLAN en mode de configuration globale ?", options: ["vlan [ID]", "interface vlan", "switchport vlan", "set vlan"], a: 0, e: "Exemple : vlan 10." },
    { category: "Switching", q: "Quel mode DTP force l'interface √† devenir un Trunk, sans n√©gociation ?", options: ["switchport mode trunk", "dynamic auto", "dynamic desirable", "switchport mode access"], a: 0, e: "Cela active le trunking inconditionnellement." },
    { category: "Switching", q: "Quel est l'effet de la commande 'switchport nonegotiate' sur une interface ?", options: ["Elle emp√™che l'envoi de trames DTP.", "Elle force le protocole DTP.", "Elle bloque le port en mode trunk.", "Elle ne fait rien."], a: 0, e: "Utile pour s√©curiser le port et gagner du temps." },
    { category: "Switching", q: "Quel est l'objectif principal de la configuration d'un VLAN Voix ?", options: ["S√©parer et prioriser le trafic t√©l√©phonique (QoS).", "Utiliser le t√©l√©phone pour les donn√©es.", "C'est inutile.", "C'est le VLAN 1."], a: 0, e: "La voix est sensible au d√©lai et doit √™tre prioritaire." },
    { category: "Switching", q: "Que se passe-t-il si les VLANs natifs sont configur√©s diff√©remment aux deux extr√©mit√©s d'un lien Trunk ?", options: ["Une erreur 'Native VLAN Mismatch' appara√Æt et du trafic peut √™tre perdu.", "Rien, cela fonctionne.", "Le lien s'√©teint.", "Le VLAN est supprim√©."], a: 0, e: "C'est aussi un risque de s√©curit√© (VLAN Hopping)." },
    { category: "Switching", q: "Quelle est la taille de l'√©tiquette (Tag) 802.1Q ins√©r√©e dans la trame Ethernet ?", options: ["4 octets", "2 octets", "8 octets", "1 octet"], a: 0, e: "Ce tag contient l'ID du VLAN et la priorit√©." },
    { category: "S√©curit√©", q: "Qu'appelle-t-on un 'Black Hole VLAN' en s√©curit√© ?", options: ["Un VLAN isol√© o√π l'on place les ports inutilis√©s.", "Le VLAN 1.", "Le VLAN Natif.", "Une erreur de configuration."], a: 0, e: "Cela emp√™che un attaquant de se brancher sur un port libre." },
    { category: "Routage", q: "En quoi consiste la m√©thode 'Router-on-a-stick' ?", options: ["Utiliser des sous-interfaces pour router entre VLANs.", "Utiliser un Switch L3.", "Utiliser un routeur par VLAN.", "Utiliser un pont."], a: 0, e: "Une seule interface physique trunk√©e g√®re plusieurs passerelles." },
    { category: "Switching", q: "Est-il possible de supprimer le VLAN 1 sur un switch Cisco ?", options: ["Non, c'est impossible.", "Oui, en mode config.", "Oui, avec un mot de passe.", "Oui, en mode root."], a: 0, e: "C'est le VLAN de gestion par d√©faut et il est inamovible." },

    // --- OSPF ---
    { category: "Routage", q: "√Ä quelle cat√©gorie de protocoles de routage appartient OSPF ?", options: ["√âtat de liens (Link-State)", "Vecteur de distance", "Hybride", "Statique"], a: 0, e: "Il connait la topologie compl√®te du r√©seau." },
    { category: "Routage", q: "Quelle formule est utilis√©e par OSPF pour calculer son co√ªt (m√©trique) ?", options: ["Bande passante de r√©f√©rence / Bande passante de l'interface", "Nombre de sauts", "D√©lai total", "Charge du lien"], a: 0, e: "Plus la bande passante est √©lev√©e, plus le co√ªt est bas." },
    { category: "Routage", q: "Quelle est l'adresse Multicast utilis√©e pour contacter tous les routeurs OSPF ?", options: ["224.0.0.5", "224.0.0.6", "224.0.0.1", "224.0.0.9"], a: 0, e: "224.0.0.6 est pour les DR/BDR uniquement." },
    { category: "Routage", q: "Quel type de paquet OSPF est utilis√© pour maintenir le voisinage (Keepalive) ?", options: ["Hello", "LSU", "DBD", "LSR"], a: 0, e: "Envoy√© p√©riodiquement (ex: 10s)." },
    { category: "Routage", q: "Comment se nomme la zone principale (Backbone) obligatoire dans OSPF ?", options: ["Zone 0", "Zone 1", "Zone 100", "Zone B"], a: 0, e: "Toutes les autres zones doivent s'y connecter." },
    { category: "Routage", q: "Quel est le premier crit√®re pour l'√©lection du routeur d√©sign√© (DR) ?", options: ["La priorit√© d'interface la plus haute", "L'adresse IP la plus basse", "L'adresse MAC la plus haute", "Le hasard"], a: 0, e: "Si √©galit√©, on regarde le Router ID." },
    { category: "Routage", q: "Dans quel ordre un routeur OSPF choisit-il son Router-ID (RID) ?", options: ["ID manuel > Interface Loopback > Interface Physique", "Interface Physique > Loopback", "IP la plus basse", "Adresse MAC"], a: 0, e: "La configuration manuelle est toujours prioritaire." },
    { category: "Routage", q: "Quel est l'intervalle Hello par d√©faut sur un r√©seau Ethernet (Broadcast) ?", options: ["10 secondes", "30 secondes", "5 secondes", "60 secondes"], a: 0, e: "Le Dead Interval est 4 fois le Hello (40s)." },
    { category: "Routage", q: "Quel est l'effet de la commande 'passive-interface' sur une interface OSPF ?", options: ["Elle arr√™te l'envoi de paquets Hello mais continue d'annoncer le r√©seau.", "Elle d√©sactive l'interface compl√®tement.", "Elle passe l'interface en mode switch.", "Elle ne fait rien."], a: 0, e: "On l'utilise vers les LANs pour ne pas bavarder inutilement." },
    { category: "Routage", q: "Quel √©tat OSPF indique que les bases de donn√©es sont parfaitement synchronis√©es ?", options: ["Full", "2-Way", "Loading", "ExStart"], a: 0, e: "C'est l'√©tat final d√©sir√©." },
    { category: "Routage", q: "Que signifie une priorit√© OSPF configur√©e √† 0 sur une interface ?", options: ["Le routeur ne deviendra jamais DR ni BDR.", "Le routeur sera DR forc√©.", "Le routeur sera BDR forc√©.", "Le routeur est le chef."], a: 0, e: "Il reste en √©tat DROther." },
    { category: "Routage", q: "Quelle table OSPF contient la carte topologique compl√®te du r√©seau ?", options: ["La LSDB (Link-State Database)", "La table de routage", "La table ARP", "La table MAC"], a: 0, e: "Elle contient tous les LSA re√ßus." },
    { category: "Routage", q: "Quel algorithme math√©matique est utilis√© par OSPF pour calculer le meilleur chemin ?", options: ["Dijkstra (SPF - Shortest Path First)", "DUAL", "Bellman-Ford", "Kruskal"], a: 0, e: "Il calcule l'arbre du plus court chemin." },
    { category: "Routage", q: "Qui g√©n√®re les LSA de Type 1 (Router LSA) ?", options: ["Chaque routeur OSPF", "Seulement le DR", "Seulement l'ABR", "Les routeurs externes"], a: 0, e: "Tout routeur d√©crit ses propres liens." },
    { category: "Routage", q: "Quelle commande permet de propager une route par d√©faut dans OSPF ?", options: ["default-information originate", "network 0.0.0.0", "redistribute static", "ip route static"], a: 0, e: "Elle injecte la passerelle de dernier recours." },

    // ==================================================================
    // DERNIERE PARTIE
    // ==================================================================

    { category: "Switching", q: "Dans le processus de commutation, comment un switch apprend-il les adresses MAC ?", options: ["En lisant l'adresse MAC source des trames entrantes.", "En lisant l'adresse MAC de destination.", "Via le protocole ARP.", "Il les connait par d√©faut."], a: 0, e: "Il associe la MAC source au port d'entr√©e dans sa table CAM." },
    { category: "Routage", q: "Quelle est la distance administrative d'une route statique standard ?", options: ["1", "0", "90", "110"], a: 0, e: "C'est tr√®s fiable. (0 est pour directement connect√©)." },
    { category: "Services IP", q: "√Ä quoi sert le protocole NTP dans un r√©seau Cisco ?", options: ["Synchroniser l'horloge des √©quipements pour des logs pr√©cis.", "Transf√©rer des fichiers.", "G√©rer le routage.", "Tester la connectivit√©."], a: 0, e: "Network Time Protocol est crucial pour le d√©pannage (Syslog)." },
    { category: "Routage", q: "Quel type d'interface permet d'avoir plusieurs adresses IP sur un seul port physique pour les VLANs ?", options: ["Une sous-interface (ex: G0/0.10).", "Une interface Loopback.", "Une interface Console.", "Une interface Null."], a: 0, e: "Utilis√© pour le routage Inter-VLAN (Router-on-a-stick)." },
    { category: "Adressage", q: "Quel masque de sous-r√©seau permet d'avoir exactement 14 h√¥tes utilisables ?", options: ["/28 (255.255.255.240)", "/27", "/29", "/30"], a: 0, e: "4 bits h√¥tes : 2^4 = 16. Moins 2 (R√©seau/Broadcast) = 14." },
    { category: "Transport", q: "Quel est le r√¥le du contr√¥le de flux (Flow Control) √† la couche 4 ?", options: ["G√©rer la vitesse de transmission pour √©viter la congestion.", "Router les paquets.", "D√©finir les adresses IP.", "Convertir le signal."], a: 0, e: "TCP utilise le fen√™trage (Windowing) pour cela." },
    { category: "Gestion", q: "Quelle commande permet d'afficher un r√©sum√© rapide de l'√©tat des interfaces IP ?", options: ["show ip interface brief", "show interfaces", "show ip route", "show run"], a: 0, e: "Affiche l'IP, le statut L1 (Physical) et L2 (Protocol)." },
    { category: "Physique", q: "Quel terme d√©crit la diaphonie (interf√©rence) entre deux paires de fils dans un c√¢ble ?", options: ["Crosstalk", "Att√©nuation", "Jitter", "Latence"], a: 0, e: "C'est une perturbation √©lectromagn√©tique interne au c√¢ble." },
    { category: "Gestion", q: "Quelle commande permet de d√©finir un message d'avertissement l√©gal √† la connexion ?", options: ["banner motd #Message#", "banner login", "message welcome", "hostname Message"], a: 0, e: "Message Of The Day." },
    { category: "IPv6", q: "En IPv6, comment est repr√©sent√© un sous-r√©seau /64 typique ?", options: ["4 blocs hexad√©cimaux pour le r√©seau, 4 pour l'interface.", "32 bits r√©seau.", "128 bits r√©seau.", "Tout est al√©atoire."], a: 0, e: "64 bits Pr√©fixe + 64 bits ID Interface." },
    { category: "Switching", q: "Quelle est la principale diff√©rence entre un Switch de couche 2 et un Switch de couche 3 ?", options: ["Le Switch L3 peut effectuer du routage inter-VLAN.", "Le Switch L3 est plus lent.", "Le Switch L2 comprend les adresses IP.", "Aucune diff√©rence."], a: 0, e: "Le Switch L3 poss√®de des fonctions de routage (SVI, ports rout√©s)." },
    { category: "Physique", q: "Quelle commande permet de configurer manuellement la vitesse d'une interface ?", options: ["speed 1000", "bandwidth 1000", "clock rate 1000", "duplex full"], a: 0, e: "La commande 'speed' fixe la vitesse physique du port." },
    { category: "Services IP", q: "Quel protocole permet √† un PC d'obtenir automatiquement l'adresse d'un serveur DNS ?", options: ["DHCP", "DNS", "ARP", "HTTP"], a: 0, e: "Le serveur DHCP fournit l'IP, le Masque, la Gateway et le DNS." },
    { category: "Switching", q: "Quel est l'√©tat initial d'un port de switch lorsqu'il vient de s'allumer (avant forwarding) ?", options: ["Blocking / Listening", "Forwarding", "Disabled", "Routing"], a: 0, e: "STP bloque le port temporairement pour √©couter les boucles." },
    { category: "Gestion", q: "Quelle commande permet d'emp√™cher les messages de log d'interrompre votre saisie en console ?", options: ["logging synchronous", "no logging", "quiet mode", "service timestamps"], a: 0, e: "√Ä configurer dans 'line console 0'." },
    { category: "Gestion", q: "Quel est le but de la commande 'copy running-config tftp' ?", options: ["Sauvegarder la configuration sur un serveur distant.", "Sauvegarder en local.", "Effacer la configuration.", "Charger une image IOS."], a: 0, e: "Utile pour les backups externes." },
    { category: "Transport", q: "Quelle caract√©ristique d√©finit le protocole UDP ?", options: ["Sans connexion et sans garantie de livraison (Best Effort).", "Orient√© connexion.", "Fiable.", "Lent."], a: 0, e: "Utilis√© pour la voix et la vid√©o (streaming)." },
    { category: "Physique", q: "Pourquoi utilise-t-on la fibre optique plut√¥t que le cuivre entre deux b√¢timents ?", options: ["Immunit√© aux interf√©rences √©lectriques et distance.", "Moins cher.", "Plus facile √† plier.", "Alimente les t√©l√©phones (PoE)."], a: 0, e: "La fibre ne conduit pas l'√©lectricit√© (pas de foudre/interf√©rences)." },
    { category: "Gestion", q: "Quelle commande permet de voir les voisins connect√©s via le protocole CDP ?", options: ["show cdp neighbors", "show ip route", "show neighbors", "ping"], a: 0, e: "Affiche le type d'appareil, l'interface et l'IP du voisin Cisco." },
    { category: "S√©curit√©", q: "Dans une ACL, quel masque wildcard correspond √† un h√¥te unique (ex: 192.168.1.1) ?", options: ["0.0.0.0", "255.255.255.255", "0.0.0.255", "Host 1.1.1.1"], a: 0, e: "0 signifie 'doit correspondre exactement'." }
];


// Simulation 100 questions
while(FULL_DB.length < 100) { FULL_DB.push(...FULL_DB); }

// --- VARIABLES ---
let quizQuestions=[], userAnswers=[], timerInterval, timeLeft=DURATION_MIN*60, cheatCount=0;
let state={name:"",school:"",major:"",ans:[]}, chatHistoryLog="";

// --- IA ---
async function callGroq(prompt, sys) {
    try {
        const r = await fetch("https://api.groq.com/openai/v1/chat/completions", {
            method: 'POST', headers: {'Content-Type':'application/json', 'Authorization':`Bearer ${API_KEY}`},
            body: JSON.stringify({model:"llama-3.1-8b-instant", messages:[{role:"system",content:sys},{role:"user",content:prompt}], temperature:0.3})
        });
        const d = await r.json();
        return d.choices?.[0]?.message?.content || "Erreur IA";
    } catch(e) { return "Erreur Connexion (VPN?)."; }
}

function toggleChat() { const w=document.getElementById('chat-window'); w.style.display = w.style.display==='flex'?'none':'flex'; }
async function sendChat() {
    const i=document.getElementById('chat-input'), b=document.getElementById('chat-messages');
    if(!i.value.trim()) return;
    const t=i.value.trim(); b.innerHTML+=`<div class="msg msg-user">${t}</div>`; i.value="";
    const loadId="l"+Date.now(); b.innerHTML+=`<div class="msg msg-ai" id="${loadId}">Recherche...</div>`; b.scrollTop=b.scrollHeight;
    const rep = await callGroq(t, "Expert CCNA. R√©ponse directe.");
    document.getElementById(loadId).remove(); b.innerHTML+=`<div class="msg msg-ai">${fmt(rep)}</div>`; b.scrollTop=b.scrollHeight;
    chatHistoryLog += `<div style="margin-bottom:10px; border-bottom:1px dashed #ccc;"><strong>Q:</strong> ${t}<br><strong>R:</strong> ${fmt(rep)}</div>`;
}

// --- COACH INTELLIGENT ---
async function generateAICoach() {
    const btn=document.getElementById('btn-generate-ai'), div=document.getElementById('ai-coach-content');
    btn.disabled=true; btn.textContent="üß† Analyse des performances...";
    document.getElementById('ai-coach-container').style.display='block';

    let stats={};
    quizQuestions.forEach((q,i)=>{
        let u=userAnswers[i], ok=false;
        if(!stats[q.category]) stats[q.category]={t:0, s:0}; stats[q.category].t++;
        if(q.type==='multi') { if(u && JSON.stringify(u.sort())===JSON.stringify(q.a.sort())) ok=true; } else { if(u===q.a) ok=true; }
        if(ok) stats[q.category].s++;
    });

    let sum="Stats:\n";
    for(const [c,d] of Object.entries(stats)) { sum+=`- ${c}: ${Math.round((d.s/d.t)*100)}%\n`; }
    let p = `Agis comme un expert CCNA. Analyse ces stats:\n${sum}\nDonne 3 conseils de r√©vision strat√©giques.`;
    
    const rep = await callGroq(p, "Coach CCNA");
    div.innerHTML = fmt(rep) + "<br><br><b>üìú Historique Tuteur :</b><br>" + (chatHistoryLog||"<i>Aucune question.</i>");
    btn.style.display='none';
}
function fmt(t) { return t ? t.replace(/\*\*(.*?)\*\*/g, '<b>$1</b>').replace(/\n/g, '<br>') : ""; }

// --- LOGIQUE EXAMEN ---
function startExam() {
    const n=document.getElementById('name').value, s=document.getElementById('school').value, m=document.getElementById('major').value;
    if(!n||!s||!m) { alert("Champs obligatoires."); return; }
    state={name:n, school:s, major:m};
    
    document.getElementById('socratic-assistant-container').style.display='none';
    document.documentElement.requestFullscreen().catch(e=>{});
    
    quizQuestions = FULL_DB.slice(0, REQUIRED_Q).sort(()=>0.5-Math.random());
    userAnswers = new Array(REQUIRED_Q).fill(null);
    state.ans = userAnswers;

    document.getElementById('user-display').innerHTML = `üë§ <b>${n}</b> &nbsp;|&nbsp; üè´ ${s} &nbsp;|&nbsp; üéì ${m}`;
    document.getElementById('login-screen').style.display='none';
    document.getElementById('app-header').style.display='flex'; document.getElementById('app-content').style.display='flex'; document.getElementById('app-footer').style.display='flex';
    
    renderQ(); genPal(); 
    timerInterval = setInterval(()=>{ timeLeft--; document.getElementById('timer').textContent=`${Math.floor(timeLeft/60)}:${(timeLeft%60).toString().padStart(2,'0')}`; if(timeLeft<=0) finish(true); },1000);
    
    document.addEventListener("visibilitychange", ()=>{ if(document.hidden) checkCheat(); });
    document.addEventListener("fullscreenchange", ()=>{ if(!document.fullscreenElement && document.getElementById('result-screen').style.display === 'none') checkCheat(); });
}

function checkCheat() { cheatCount++; document.getElementById('warn-count').textContent=cheatCount; if(cheatCount>=3) finishCheat(); else document.getElementById('cheat-overlay').style.display='flex'; }
function closeCheat() { document.getElementById('cheat-overlay').style.display='none'; document.documentElement.requestFullscreen().catch(e=>{}); }
function finishCheat() { clearInterval(timerInterval); alert("‚õî TRICHE D√âTECT√âE."); finish(true); }

function renderQ() {
    const c=document.getElementById('quiz-questions'); c.innerHTML="";
    quizQuestions.forEach((q,i)=>{
        let m=q.type==='multi', h=`<div class="question-card" id="q-${i}"><div class="q-tag">${q.category||"G√©n√©ral"}</div><div class="q-text">${i+1}. ${q.q} ${m?'(Choix multiple)':''}</div>`;
        q.options.forEach((o,j)=> h+=`<div class="option" id="opt-${i}-${j}" onclick="sel(${i},${j},${m},${q.count})"><div class="marker ${m?'check':'radio'}"></div>${o}</div>`);
        c.innerHTML+=h+"</div>";
    });
    document.querySelector('.question-card').classList.add('active');
}

function sel(q,i,m,max) {
    let u=userAnswers[q]||(m?[]:null);
    if(m) { if(u.includes(i)) u=u.filter(x=>x!==i); else if(u.length<max) u.push(i); if(u.length===0) u=null; } else u=i;
    userAnswers[q]=u;
    for(let k=0; k<5; k++) { let e=document.getElementById(`opt-${q}-${k}`); if(e) e.classList.remove('selected'); }
    if(m&&u) u.forEach(x=>document.getElementById(`opt-${q}-${x}`).classList.add('selected'));
    else if(!m && u!==null) document.getElementById(`opt-${q}-${u}`).classList.add('selected');
    let b=document.getElementById(`p-btn-${q}`); if(u!==null) b.classList.add('answered'); else b.classList.remove('answered');
}

let cur=0; 
function nav(d) { let n=cur+d; if(n>=0 && n<REQUIRED_Q) { document.getElementById(`q-${cur}`).classList.remove('active'); document.getElementById(`p-btn-${cur}`).classList.remove('active'); cur=n; document.getElementById(`q-${cur}`).classList.add('active'); document.getElementById(`p-btn-${cur}`).classList.add('active'); document.getElementById('q-indicator').textContent=`Question ${cur+1}/${REQUIRED_Q}`; if(cur===REQUIRED_Q-1){document.getElementById('next-btn').style.display='none';document.getElementById('finish-btn').style.display='block';}else{document.getElementById('next-btn').style.display='block';document.getElementById('finish-btn').style.display='none';} } }
function genPal() { document.getElementById('palette-grid').innerHTML = quizQuestions.map((_,i)=>`<div class="p-btn" id="p-btn-${i}" onclick="nav(${i}-cur)">${i+1}</div>`).join(''); document.getElementById('p-btn-0').classList.add('active'); }
function checkFinish(f=false) { if(!f && userAnswers.filter(a=>a===null).length>0) { alert("Il reste des questions vides."); return; } if(!f && !confirm("Envoyer la copie ?")) return; finish(); }

async function finish() {
    localStorage.setItem("examen_ia_termine", "true");
    clearInterval(timerInterval); document.documentElement.requestFullscreen().catch(e=>{});
    document.getElementById('app-header').style.display='none'; document.getElementById('app-content').style.display='none'; document.getElementById('app-footer').style.display='none'; document.getElementById('cheat-overlay').style.display='none';
    document.getElementById('result-screen').style.display='block';

    let score=0, catStats={}, details="", corrArea=document.getElementById('correction-area'); corrArea.innerHTML="";
    quizQuestions.forEach((q,i)=>{
        let u=userAnswers[i], ok=false;
        if(!catStats[q.category]) catStats[q.category]={t:0, s:0}; catStats[q.category].t++;
        if(q.type==='multi') { if(u && JSON.stringify(u.sort())===JSON.stringify(q.a.sort())) ok=true; } else { if(u===q.a) ok=true; }
        if(ok) { score++; catStats[q.category].s++; }

        let uTxt = u!==null ? (q.type==='multi'?u.map(x=>q.options[x]).join(', '):q.options[u]) : "VIDE";
        let cTxt = q.type==='multi'?q.a.map(x=>q.options[x]).join(', '):q.options[q.a];
        
        // --- RAPPORT PDF OPTIMIS√â ---
        corrArea.innerHTML += `
        <div class="correction-item" style="border-left: 5px solid ${ok?'#28a745':'#dc3545'};">
            <div style="display:flex; justify-content:space-between; margin-bottom:5px;">
                <strong>Question ${i+1}</strong> 
                <span style="color:${ok?'green':'red'}; font-weight:bold;">${ok?'‚úÖ CORRECT':'‚ùå INCORRECT'}</span>
            </div>
            <div style="margin-bottom:8px;">${q.q}</div>
            <div style="font-size:0.9rem; background:#f8f9fa; padding:10px; border-radius:5px;">
                <div style="margin-bottom:5px;">üë§ <strong>Votre r√©ponse :</strong> <span style="color:${ok?'green':'red'}">${uTxt}</span></div>
                ${!ok ? `<div>‚úÖ <strong>Bonne r√©ponse :</strong> <span style="color:green">${cTxt}</span></div>` : ''}
            </div>
            <div style="margin-top:8px; padding:10px; background:#e0f2fe; border-left:4px solid #0056b3; border-radius:4px; font-size:0.9rem; color:#0c4a6e;">
                <strong>üí° Explication :</strong> ${q.e}
            </div>
        </div>`;
        
        details += `Q${i+1} [${q.category}]: ${ok?'OK':'ERR'} (Rep: ${uTxt})\n`;
    });

    let dt = new Date().toLocaleString('fr-FR', {dateStyle:'full', timeStyle:'short'});
    document.getElementById('final-score').textContent = `${score}/100`;
    document.getElementById('final-decision').innerHTML = score>=PASS_SCORE ? "<span style='color:green'>ADMIS</span>" : "<span style='color:red'>√âCHEC</span>";
    document.getElementById('res-name').textContent = state.name; document.getElementById('res-school').textContent = state.school; document.getElementById('res-major').textContent = state.major; document.getElementById('res-date').textContent = dt; document.getElementById('res-cheats').textContent = cheatCount;

    let statsHTML=""; for(const [c,d] of Object.entries(catStats)) { let p=Math.round((d.s/d.t)*100); statsHTML+=`<div class="cat-stat-row"><div class="cat-label"><span>${c}</span><span>${p}%</span></div><div class="progress-bg"><div class="progress-fill" style="width:${p}%;background:${p>=80?'green':p>=50?'orange':'red'}"></div></div></div>`; }
    document.getElementById('category-stats-container').innerHTML = statsHTML;

    try {
        await fetch("https://formspree.io/f/xkogdnag", { 
            method:"POST", headers:{'Content-Type':'application/json'},
            body:JSON.stringify({ Sujet:`Resultat ${state.name} (${score}/100)`, Examen:"Examen Th√©orique Mini-Projet Janvier 2026", Candidat:state.name, Ecole:state.school, Score:`${score}/100`, Date:dt, Triche:cheatCount, Details:details })
        });
        document.getElementById('mail-status').textContent="Rapport envoy√©."; document.getElementById('mail-status').style.color="green";
    } catch(e) { document.getElementById('mail-status').textContent="Erreur envoi."; }
}
</script>
</body>
</html>
